var GLOBAL_URL,device_height,device_width;GLOBAL_URL="http://shortfilm.staging.wpengine.com",device_width="",device_height="";var shortFilmWindow;shortFilmWindow=angular.module("SFWApp",["ionic","ngCordova","ngAnimate","ngSanitize","ion-sticky","ionicLazyLoad","ionic.ion.imageCacheFactory","ionic.contrib.ui.ionThread","templates"]),shortFilmWindow.value("FirebaseKey",{apiKey:"AIzaSyCVSA3tkbBp7Sk_4HB3GYnfFL0u3XUbJfk",authDomain:"shortfilmwindow-e5571.firebaseapp.com",databaseURL:"https://shortfilmwindow-e5571.firebaseio.com",storageBucket:"shortfilmwindow-e5571.appspot.com",messagingSenderId:"936233723943"}).constant("PushConfig",{android:{senderID:"936233723943",clearBadge:!0},ios:{senderID:"936233723943",gcmSandbox:!0,clearBadge:!0,alert:!0,badge:!0,sound:!1}}),shortFilmWindow.run(["PushConfig","FirebaseApi","$ionicPlatform","$state","$rootScope","App","$timeout","$window","$cordovaNetwork","$cordovaToast","DetailsAPI",function(e,t,i,n,r,o,a,l,s,c,u){return i.ready(function(){var i,n,a;return r.isAndroid=ionic.Platform.isAndroid(),t.firebaseInit(),console.log(ionic.Platform.platform(),"IONIC"),ionic.Platform.isWebView()?(a=PushNotification.init(e),a.on("registration",function(e){var i;return console.log("DEVICE ID ->",e.registrationId),i=ionic.Platform.platform(),console.log(i,"PLATFROM NAME"),a.subscribe(""+i,function(){return console.log("SUB : success")},function(e){return console.log("error:"),console.log(e)}),t.registerDevice(e.registrationId)}),a.on("notification",function(e){return console.log(e),r.$broadcast("receiveNotification",{payload:e})})):t.registerDevice("DUMMY_UUID"),t.fetchNotifications().then(function(e){return console.log(e,"NOTIFICATIONS")},function(e){return console.log("ERROR")}),t.getUnreadNotificationsCount(),r.App=o,n=l.innerWidth,i=l.innerHeight,r.device_height=l.innerHeight,o.hideSplashScreen(),console.log("Checking if initial"),console.log(o.isInitialRun()),o.isInitialRun()?(o.setInitialRun(!1),o.navigate("appSlides")):o.navigate("appInitialize")}),i.registerBackButtonAction(function(e){var t;"popular"===n.current.name?navigator.app.exitApp():(t=-1,o.goBack(t))},100),window.fbAsyncInit=function(){FB.init({appId:"586411814878247",version:"v2.4",cookie:!0,xfbml:!0})},function(e,t,i){var n,r;r=void 0,n=e.getElementsByTagName(t)[0],e.getElementById(i)||(r=e.createElement(t),r.id=i,r.src="https://connect.facebook.net/en_US/sdk.js",n.parentNode.insertBefore(r,n))}(document,"script","facebook-jssdk"),r.$on("$stateChangeSuccess",function(e,t,i,n,a){return console.log("FROM : "+n.name+" , TO : "+t.name),"notifications"===t.name?r.pageHeader="Notifications":r.pageHeader="ShortFilmWindow",""===n.name&&"init"===t.name?o.fromNotification=1:o.previousState=n.name,o.currentState=t.name}),r.$on("$stateChangeStart",function(e,t,i,n,r){if(""!==n.name&&"appInitialize"===t.name)return e.preventDefault()})}]),shortFilmWindow.config(["$compileProvider","$ionicConfigProvider","$sceDelegateProvider",function(e,t,i){return t.scrolling.jsScrolling(!1),e.debugInfoEnabled(!1),i.resourceUrlWhitelist(["self",new RegExp("^(http[s]?)://(w{3}.)?youtube.com/.+$")])}]);var htmlEnDeCode;htmlEnDeCode=function(){var e,t,i,n,r,o,a,l;return i=void 0,r=void 0,t=void 0,n=void 0,l=function(){t={},n={},e({"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"',"&#39;":"'"})},e=function(e){var o,a,l,s,c;o=[],l=[],s=void 0,a=void 0;for(c in e)a=e[c],n[c]=a,t[a]=c,o.push(a),l.push(c);i=new RegExp("("+o.join("|")+")","g"),r=new RegExp("("+l.join("|")+"|&#[0-9]{1,5};)","g")},a=function(e){var n;return n=function(e,i){return t[i]},e?String(e).replace(i,n):e},o=function(e){var t;return t=function(e,t){return t in n?n[t]:String.fromCharCode(parseInt(t.substr(2),10))},e?String(e).replace(r,t):e},l(),{htmlEncode:a,htmlDecode:o}}(),shortFilmWindow.controller("watchlistCtrl",["$scope","Storage","DetailsAPI","App","$window","$ionicScrollDelegate","$timeout",function(e,t,i,n,r,o,a){return e.watchlistDetails=[],e.display="loader",e.watchFlag="0",e.refreshSwiper=!0,e.addvideoDetails=[],e.init=function(){return e.getData()},e.getData=function(){return t.watchlistDetails("get").then(function(t){var i,n;return console.log(t),e.watchlistDetails=t,_.isNull(e.watchlistDetails)?(e.display="no_result",e.$apply()):e.watchlistDetails.length>0?(n=r.innerWidth,i=r.innerHeight,e.used_height=133,e.hgt=i-e.used_height,e.display="result",e.$apply()):(e.display="no_result",e.$apply())})},e.updatewatchlist=function(t){return e.CheckWatchlist(t),o.resize()},e.singlePlayService=function(e){return i.singleVideoarray.movie_id=e.movie_id,i.singleVideoarray.singleVideoarray=e,n.navigate("init")},e.CheckWatchlist=function(i){var n;return n=_.findLastIndex(e.watchlistDetails,{movie_id:i}),e.watchlistDetails.splice(n,1),t.watchlistDetails("set",e.watchlistDetails),_.isNull(e.watchlistDetails)||0===e.watchlistDetails.length?e.display="no_result":(e.refreshSwiper=!1,a(function(){var t,i;return e.refreshSwiper=!0,i=r.innerWidth,t=r.innerHeight,e.used_height=115,e.hgt=t-e.used_height},100))}}]),shortFilmWindow.factory("App",["$state","$ionicHistory","$window","$cordovaNetwork",function(e,t,i,n){var r;return r=void 0,r={start:!0,unreadNotifications:0,menuEnabled:{left:!1,right:!1},previousState:"",currentState:"",fromNotification:0,notificationPayload:[],navigate:function(i,n,r){var o,a;return o=void 0,a=void 0,null===n&&(n={}),null===r&&(r={}),_.isEmpty(r)||(o=!!_.has(r,"animate")&&r.animate,a=!!_.has(r,"back")&&r.back,t.nextViewOptions({disableAnimate:!o,disableBack:!a})),e.go(i,n)},getbackView:function(){return console.log(t.backView())},goBack:function(i){return console.log("in back function"),console.log(this.previousState),console.log(this.currentState),this.fromNotification?(this.fromNotification=0,e.go("popular")):t.goBack(i)},isAndroid:function(){return ionic.Platform.isAndroid()},isIOS:function(){return ionic.Platform.isIOS()},isWebView:function(){return ionic.Platform.isWebView()},isOnline:function(){return this.isWebView()?n.isOnline():navigator.onLine},deviceUUID:function(){return this.isWebView()?device.uuid:"DUMMYUUID"},hideKeyboardAccessoryBar:function(){if(i.cordova&&i.cordova.plugins.Keyboard)return $cordovaKeyboard.hideAccessoryBar(!0)},hideSplashScreen:function(){if(navigator.splashscreen)return navigator.splashscreen.hide()},hideKeyboard:function(){if(this.isWebView()&&cordova.plugins.Keyboard)return cordova.plugins.Keyboard.close()},showKeyboard:function(){return!0},setInitialRun:function(e){i.localStorage.initialRun=e?"true":"false"},isInitialRun:function(){var e;return e=i.localStorage.initialRun||"true","true"===e}}}]),shortFilmWindow.directive("ajError",[function(){return{restrict:"E",replace:!0,templateUrl:"Global/error.html",scope:{tapToRetry:"&",errorType:"="},link:function(e,t,i){var n,r,o;switch(e.errorType){case"offline":r="No internet availability",o="Error",n="Retry";break;case"server_error":r="Could not connect to server";break;case"no_Search_result":r="No results found",o="Result",n="Close";break;default:r="Something Went Wrong",o="Error",n="Retry"}return e.errorMsg=r,e.errorTitle=o,e.button=n,e.onTryAgain=function(){return e.tapToRetry()}}}}]),shortFilmWindow.factory("share",["$q","App","$http",function(e,t,i){var n;return n={},n.shareNative=function(e,t){var i,n;if(null==t&&(t=""),console.log("Sharing video",e,t),i="http://shortfilm.staging.wpengine.com/",window.plugins&&window.plugins.socialsharing){switch(t){case"":n=i+"/"+e;break;default:n=i+"/"+t+"/"+e}return window.plugins.socialsharing.share(null,"shortFilm Window",null,n,function(){return console.log("Success")},function(e){return console.log("Share fail "+e)})}return console.log("Share plugin not available")},n}]),shortFilmWindow.controller("playerCtrl",["$scope","$sce","DetailsAPI","$ionicHistory","App","$timeout",function(e,t,i,n,r,o){var a;return e.temp="temp",e.videoDetails=i.singleVideoarray,e.videourl=e.videoDetails.singleVideoarray.videourl,a=null,e.switchHeaderBar=!0,o(function(){return e.switchHeaderBar=!e.switchHeaderBar},5e3),e.toggleHeader=function(){return e.switchHeaderBar=!e.switchHeaderBar,o(function(){return e.switchHeaderBar=!e.switchHeaderBar,e.$apply()},5e3)},e.view={back:function(){var e;return e=-1,r.goBack(e)},vType:e.videoDetails.singleVideoarray.type,vimomeo:!0,init:function(){var i,n,r;return"vimeo"===this.vType?(i=e.videoDetails.singleVideoarray.embedurl,this.vimomeo=!0,e.player1=t.trustAsResourceUrl(i)):(this.vimomeo=!1,console.log(e.videoDetails.singleVideoarray,"videoDetails"),i=e.videoDetails.singleVideoarray.embedurl,r=function(){return a=new YT.Player("player2",{height:"100%",width:"100%",videoId:e.videoDetails.singleVideoarray.videourl,events:{onReady:n}})},n=function(e){return console.log("PLAY"),e.target.playVideo()},e.player2=t.trustAsResourceUrl(i),r())}}}]),shortFilmWindow.factory("FacebookGraphAPI",["$q","$http",function(e,t){var i;return i={},i.comments=[],i.graphURL="https://graph.facebook.com/comments?id="+GLOBAL_URL,i.slug="",i.accessToken="",i.getAllComments=function(n){var r;return r=e.defer(),i.slug=n,t.get(i.graphURL+"/"+n+"/&filter=stream&fields=from,message,user_likes,link,name,caption,description,created_time,updated_time,likes,like_count,comments{from,message,link,name,caption,description,created_time,updated_time,like_count}").then(function(e){return console.log(e),i.comments=e.data,r.resolve(i.comments)},function(e){return r.reject(data)}),r.promise},i.checkLoginStatus=function(){var t;return t=e.defer(),facebookConnectPlugin.getLoginStatus(function(e){return console.log("User logged in"),console.log(e),t.resolve(e)},function(e){return t.reject(e)}),t.promise},i.loginToFacebook=function(){var t,n;return t=e.defer(),n=function(e){return console.log("Login Success"),console.log("UserInfo: ",e),i.accessToken=e.authResponse.accessToken,t.resolve(e)},facebookConnectPlugin.login(["manage_pages","publish_pages"],n,function(e){return console.log("Login Error"),console.error(e),t.reject(e)}),t.promise},i}]),shortFilmWindow.factory("DetailsAPI",["$q","App","$http","$ImageCacheFactory",function(e,t,i,n){var r;return r={},r.videoId="",r.array_addition=[],r.array_noteworthy=[],r.array_awplaylist=[],r.array_mostpopular=[],r.genre_array=[],r.playlist_array=[],r.Global_array=[],r.GlobalChild_array=[],r.Filter=[],r.Sort=[],r.array=[],r.singleVideoarray=[],r.imagArray=[],r.initialize=0,r.GetVideoDetails=function(){var t;return t=e.defer(),i.get(GLOBAL_URL+"/wp-json/get_defaults").then(function(e){return console.log("In get video details api",e),t.resolve(e.data)},function(e){return t.reject(e)}),t.promise},r.GetSingleVideo=function(t){var n;return n=e.defer(),i.get(GLOBAL_URL+("/wp-json/get_video?id="+t)).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e)}),n.promise},r.searchResult=function(t){var n;return n=e.defer(),i.get(GLOBAL_URL+("/wp-json/search?str="+t)).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e)}),n.promise},r.setData=function(e){return null==e&&(e={}),r.array=e.premiere,r.array_addition=e.new_addition,r.array_noteworthy=e.noteworthy,r.array_awplalist=e.awesome_playlist,r.genre_array=e.genre,r.playlist_array=e.playlist,r.array_mostpopular=e.mstPopular,r.initialize=1},r}]),shortFilmWindow.factory("PulltorefreshAPI",["$q","App","$http","DetailsAPI",function(e,t,i,n){var r;return r={},r.pullrequest=function(){var t;return t=e.defer(),i.get(GLOBAL_URL+"/wp-json/get_defaults").then(function(e){return console.log("Inside get data pull to refresh",e),t.resolve(e.data)},function(e){return t.reject(e)}),t.promise},r.saveData=function(e){return null==e&&(e={}),console.log("Inside save data pull to refresh",e),n.array=e.premiere,n.array_addition=e.new_addition,n.array_noteworthy=e.noteworthy,n.array_awplalist=e.awesome_playlist,n.genre_array=e.genre,n.playlist_array=e.playlist,n.array_mostpopular=e.mstPopular},r}]),shortFilmWindow.directive("dynFbCommentBox",function(){var e,t;return e=function(e,t,i){return'<div class="fb-comments" data-href="'+e+'" data-numposts="'+t+'" data-colorsheme="'+i+'"></div>'},{restrict:"A",scope:{},link:t=function(t,i,n){return n.$observe("pageHref",function(t){var r,o,a;return o=t,a=n.dataNumposts||2,r=n.colorscheme||"light",i.html(e(o,a,r)),FB.XFBML.parse(i[0])})}}}),shortFilmWindow.directive("isLoaded",function(){return{scope:!1,restrict:"A",link:function(e,t,i){if(e.$last)return e.$emit("content-changed")}}}),shortFilmWindow.directive("scrollWatch",function(e){return function(t,i,n){var r,o;return r=0,o=150,i.bind("scroll",function(t){return t.detail.scrollTop-r>o?e.slideHeader=!0:e.slideHeader=!1,e.slideHeaderPrevious>=t.detail.scrollTop-r&&(e.slideHeader=!1),e.slideHeaderPrevious=t.detail.scrollTop-r,e.$apply()})}}),shortFilmWindow.directive("swiper",function(){return{link:function(e,t,i){return e.$on("content-changed",function(){return new Swiper(t,{direction:"vertical",pagination:".swiper-pagination",paginationClickable:!0,onSlideChangeEnd:function(t){return e.currSwiper=t,e.$apply(i.detectSwiperSlide)},onSlideChangeStart:function(t){return e.currSwiper=t,e.$apply(i.detectSwiperSlide)}})})}}}),shortFilmWindow.filter("encodeDecodeFilter",function(){return function(e){return htmlEnDeCode.htmlDecode(e)}}),shortFilmWindow.controller("InitCtrl",["$scope","App","DetailsAPI","$ionicLoading","$ionicHistory","share","Storage","$sce","FacebookGraphAPI","$cordovaOauth",function(e,t,i,n,r,o,a,l,s,c){return e.Videodetails=[],e.addvideoDetails=[],e.getwatchlistDetails=[],e.watchFlag="0",e.intFlag="0",e.watchlistimg="",e.showLoaderOrSynopsis=!0,e.appURL=GLOBAL_URL,e.showVideo=!1,e.showLoginBtn=!0,e.share=function(e){return o.shareNative(e)},e.addwatchlist=function(){return e.CheckWatchlist()},e.checkIfaddedlist=function(){return a.watchlistDetails("get").then(function(t){var i;if(e.getwatchlistDetails=t,_.isNull(e.getwatchlistDetails)||0===e.getwatchlistDetails.length)return e.watchlistimg="icon-favorite",e.$apply();for(i=0;i<e.getwatchlistDetails.length;)e.getwatchlistDetails[i].movie_id===e.Videodetails.movie_id&&(e.intFlag="1"),i++;return"1"===e.intFlag?(e.watchlistimg="icon-unfavorite",e.$apply()):(e.watchlistimg="icon-favorite",e.$apply())})},e.CheckWatchlist=function(){return a.watchlistDetails("get").then(function(t){var n,r,o;return e.getwatchlistDetails=t,r={movie_id:i.singleVideoarray.movie_id,singleVideoarray:i.singleVideoarray.singleVideoarray},_.isNull(e.getwatchlistDetails)||0===e.getwatchlistDetails.length?(e.addvideoDetails.push(r),a.watchlistDetails("set",e.addvideoDetails),e.watchlistimg="icon-unfavorite",e.$apply()):(n=_.findLastIndex(e.getwatchlistDetails,{movie_id:i.singleVideoarray.movie_id}),n!==-1?(e.getwatchlistDetails.splice(n,1),o=e.getwatchlistDetails,e.addvideoDetails=o,a.watchlistDetails("set",e.addvideoDetails),e.watchlistimg="icon-favorite",e.$apply()):(e.getwatchlistDetails.push(r),o=e.getwatchlistDetails,e.addvideoDetails=o,a.watchlistDetails("set",e.addvideoDetails),e.watchlistimg="icon-unfavorite",e.$apply()))})},e.init=function(t){return null==t&&(t=""),console.log("Inside Init controller",i.singleVideoarray.movie_id),angular.isUndefined(i.singleVideoarray.movie_id)?i.GetSingleVideo(t).then(function(t){var n;return e.display="result",n={movie_id:t.movie_id,singleVideoarray:t},i.singleVideoarray=n,e.Videodetails=t,e.showLoaderOrSynopsis=!1,e.synopsisData=e.Videodetails.content},function(e){return console.log("error")}):(e.display="result",e.Videodetails=i.singleVideoarray.singleVideoarray,console.log("Displaying video details"),console.log(GLOBAL_URL),console.log(e.Videodetails),e.checkIfaddedlist(),i.GetSingleVideo(i.singleVideoarray.movie_id).then(function(t){return e.showLoaderOrSynopsis=!1,e.synopsisData=t.content},function(e){}))},e.initializeApp=function(){return e.display="loader",console.log("INITIALIZEAPP ",i),e.init(i.videoId)},e.trustAsHtml=function(e){return l.trustAsHtml(e)},e.view={onTapToRetry:function(){return e.init()},back:function(){var e;return i.singleVideoarray=[],e=-1,t.goBack(e)},playVideo:function(){return e.showVideo=!0,t.navigate("singlePlayer")}},t.fromNotification?e.initializeApp():e.init()}]),shortFilmWindow.controller("appInitializeCtrl",["$scope","App","InitialiseService","$rootScope","$ionicPlatform",function(e,t,i,n,r){return e.initApp=function(){return console.log("APP STARTED"),t.isWebView()&&console.log("ISWEBVIEW"),e.display="loader",e.errorType="offline",t.isOnline()?i.initialize().then(function(e){return console.log(e," INITIALIZED"),t.navigate("popular")},function(t){return e.display="error"}):e.display="error"},r.ready(function(){return e.initApp()})}]),shortFilmWindow.controller("appSlidesCtrl",["$scope","App","InitialiseService","$rootScope","$ionicPlatform",function(e,t,i,n,r){return e.initApp=function(){return console.log("APP STARTED for the first time"),e.startApp=function(){return t.isOnline()?(e.apiLoading=!0,i.initialize().then(function(i){return console.log(i," INITIALIZED"),e.apiLoading=!1,t.navigate("popular")},function(t){return e.display="error"})):e.display="error"},e.next=function(){$ionicSlideBoxDelegate.next()},e.previous=function(){$ionicSlideBoxDelegate.previous()},e.slideChanged=function(t){e.slideIndex=t}},e.initApp()}]),shortFilmWindow.controller("navigateCtrl",[function(){}]).config(["$stateProvider","$urlRouterProvider",function(e,t){return e.state("appSlides",{url:"/appSlides",abstract:!1,controller:"appSlidesCtrl",templateUrl:"landingVideo/appSlides.html"}).state("appInitialize",{url:"/appInitialize",abstract:!1,controller:"appInitializeCtrl",templateUrl:"landingVideo/appInitialize.html"}).state("home",{url:"/sidebar",cache:!1,controller:"sidebarCtrl",templateUrl:"home/home.html"}).state("tabhome",{url:"/homeTab",parent:"home",abstract:!0,views:{homeview:{templateUrl:"home/homeTab.html"}}}).state("popular",{url:"/popular",parent:"tabhome",views:{popularContent:{templateUrl:"tabs/popular/popular.html",controller:"popularCtrl"}}}).state("genre",{cache:!0,url:"/genre",parent:"tabhome",views:{genreContent:{templateUrl:"tabs/genre/genre.html",controller:"genreCtrl",params:{data:null}}}}).state("playlist",{url:"/playlist",parent:"tabhome",views:{playlistContent:{templateUrl:"tabs/playlist/playlist.html",controller:"playlistCtrl"}}}).state("watchList",{url:"/watchList",cache:!1,parent:"home",views:{homeview:{templateUrl:"watchlist/myWatchlist.html",controller:"watchlistCtrl"}}}).state("notifications",{url:"/notifications",cache:!1,parent:"home",views:{homeview:{templateUrl:"notification/notifications.html",controller:"notificationsCtrl"}}}).state("init",{url:"/init",cache:!1,controller:"InitCtrl",templateUrl:"singlevideo/movieScreen.html"}).state("singlePlayer",{url:"/singlePlayer",cache:!1,controller:"playerCtrl",templateUrl:"singlevideo/singlePlayer.html"}).state("landingvideo",{url:"/landing",cache:!1,controller:"landingCtrl",templateUrl:"landingVideo/splash.html"}).state("navbar",{url:"/navbar",abstract:!1,templateUrl:"home/navBar.html"}).state("singleGenre",{url:"/singleGenre",cache:!1,controller:"singleGenre",templateUrl:"tabs/genre/singleGenre.html"}).state("singlePlaylist",{url:"/singlePlaylist",cache:!1,controller:"singlePlaylist",templateUrl:"tabs/playlist/singlePlaylist.html"})}]),shortFilmWindow.controller("notificationsCtrl",["FirebaseApi","$rootScope","$scope","App","PulltorefreshAPI","DetailsAPI","$ionicLoading","$stateParams","Storage","$timeout","$window",function(e,t,i,n,r,o,a,l,s,c,u){return i.notificationArray=[],t.$on("receiveNotification",function(e,t){return console.log("RECEIVE PUSH Notifications",e,t),i.getNotifications()}),i.view={onTapToRetry:function(){return i.getNotifications()}},i.getNotifications=function(){return console.log("GET Notifications"),t.$broadcast("refreshContent",{}),i.hgt=u.innerHeight-80,i.swiperhgt=i.hgt-31,n.isOnline()?(i.result="loader",s.watchlistDetails("get").then(function(t){return _.isNull(t)&&(t=[]),i.getwatchlistDetails=t,e.fetchNotifications().then(function(e){return console.log(e," Notifications"),0===e.length?(console.log("No data"),i.result="no-new-notifications"):(console.log("Data present"),i.refreshSwiper=!1,i.notificationArray=e,c(function(){return i.refreshSwiper=!0,i.result="display"},50))},function(e){return console.log("In error",e),i.result="error"}).catch(function(e){return console.log("In error",e),i.result="error"})})):(console.log("App not online"),i.result="error")},i.clearNotifications=function(){return n.isOnline()?(i.notificationArray=[],i.result="no-new-notifications",t.unreadNotificationCount=0,e.deleteNotifications().then(function(e){return console.log(e)}).catch(function(e){return i.result="error"})):i.result="error"},i.markNotificationAsRead=function(r){var o;return n.isOnline()?(o=_.findLastIndex(i.notificationArray,{notificationId:""+r}),"unread"===i.notificationArray[o].status?(console.log("PUsH"),e.updateNotificationStatus(r).then(function(e){return console.log(e)}).catch(function(e){return i.result="error"})):console.log("DONT PUsH"),i.notificationArray[o].status="read",t.unreadNotificationCount?t.unreadNotificationCount--:void 0):i.result="error"},i.checkIfaddedToWatchList=function(e){var t;return i.getwatchlistDetails.length>0?(t=_.findIndex(i.getwatchlistDetails,{movie_id:e}),t!==-1?"selected":"notselected"):"notselected"},i.findIndexInWatchlist=function(e){var t;return t=_.findIndex(i.getwatchlistDetails,{movie_id:e})},i.addwatchlist=function(e,t){var n,r;return i.markNotificationAsRead(t),r={movie_id:e.movie_id,singleVideoarray:e},n=i.findIndexInWatchlist(e.movie_id),n===-1?(i.getwatchlistDetails.push(r),s.watchlistDetails("set",i.getwatchlistDetails)):(i.getwatchlistDetails.splice(n,1),s.watchlistDetails("set",i.getwatchlistDetails))},i.singlePlayService=function(e,t){return console.log(t),i.markNotificationAsRead(t),o.singleVideoarray.movie_id=e.movie_id,o.singleVideoarray.singleVideoarray=e,n.navigate("init")}}]),shortFilmWindow.service("FirebaseApi",["$ionicPlatform","$q","FirebaseKey","App","Storage","PushConfig","$rootScope",function(e,t,i,n,r,o,a){var l,s;return l=null,s={},s.setDeviceToke=function(e){if(null==e&&(e=null),e)return l=e},s.getDeviceToken=function(){var e;return e=t.defer(),ionic.Platform.isWebView()?r.deviceToken("get").then(function(t){var i;return t?(l=t,e.resolve(t)):(i=PushNotification.init(o),i.on("registration",function(t){return r.deviceToken("set",t.registrationId),l=t.registrationId,e.resolve(t.registrationId)}))}):(l="AAAANbS6cgA:APA91bEFfdZj4pMPeeRTx8Ldn5LPdsRKkyPFRdCamiOwvE8O7mJZMwblKS9Fv2_3roAoCwu6bkrU_xT2vdyO28dAJNfZQJtbwC0XvxwFit5yzNXheEyzsUD7jD-_Lhl6uT0KIi_Uu4LV",r.deviceToken("set","AAAANbS6cgA:APA91bEFfdZj4pMPeeRTx8Ldn5LPdsRKkyPFRdCamiOwvE8O7mJZMwblKS9Fv2_3roAoCwu6bkrU_xT2vdyO28dAJNfZQJtbwC0XvxwFit5yzNXheEyzsUD7jD-_Lhl6uT0KIi_Uu4LV"),e.resolve("AAAANbS6cgA:APA91bEFfdZj4pMPeeRTx8Ldn5LPdsRKkyPFRdCamiOwvE8O7mJZMwblKS9Fv2_3roAoCwu6bkrU_xT2vdyO28dAJNfZQJtbwC0XvxwFit5yzNXheEyzsUD7jD-_Lhl6uT0KIi_Uu4LV")),e.promise},s.firebaseInit=function(){return console.log(" INITIALISING FIREBASE"),firebase.initializeApp(i)},s.saveNotification=function(){var e;return console.log(l),e=t.defer(),firebase.database().ref("notifications/"+l).push({movieId:930,alert:"TEST Notification",createdAt:"2016-12-22T12:56:59.706Z",updatedAt:"2016-12-22T12:57:14.455Z",movieDetails:{found:!0,movie_id:930,no_of_views:"193",no_of_likes:"189",title:"test notif",type:"youtube",tagline:"",videourl:"https://balsamiq.com/",embedurl:"https://www.youtube.com/embed/?autoplay=1",director:"ShortFilmWindow",image:"http://shortfilm.staging.wpengine.com/wp-content/themes/short-film/assets/img/placeholder.jpg",duration:"5",region:"",language:"",genres:["Uncategorized"],content:"",slug:"test-notif-2"}}).then(function(t){return e.resolve(t)},function(t){return e.reject(t)}),e.promise},s.fetchNotifications=function(){var e;return e=t.defer(),firebase.database().ref("notifications").once("value").then(function(t){var i,n,r,o,s,c,u,d,g,p,h,f;if(i=0,t.val()){for(console.log(t.val(),"NOTIFICATIONS"),f=t.val(),s=Object.keys(f),u=[],r=o=0,g=s.length;0<=g?o<g:o>g;r=0<=g?++o:--o)f[s[r]].id=s[r],p=f[s[r]],c=JSON.parse(decodeURIComponent(p.movieDetails)),d={fromnow:moment(moment.unix(p.created).toString()).fromNow(),createdAt:p.created,notificationId:p.id,alert:p.alert,movieDetails:c,status:p.status},n=!1,p.deviceIDs?(h=p.deviceIDs[l],h?h.hasCleared===!1&&h.hasSeen===!1?(d.status="unread",i++):h.hasCleared===!1&&h.hasSeen===!0&&(d.status="read"):(i++,d.status="unread")):(i++,d.status="unread"),_.isString(d.movieDetails.title)&&d.movieDetails.title.indexOf("+")!==-1&&(d.movieDetails.title=d.movieDetails.title.replace(/\+/g," ")),_.isString(d.movieDetails.director)&&d.movieDetails.director.indexOf("+")!==-1&&(d.movieDetails.director=d.movieDetails.director.replace(/\+/g," ")),_.isString(d.movieDetails.tagline)&&d.movieDetails.tagline.indexOf("+")!==-1&&(d.movieDetails.tagline=d.movieDetails.tagline.replace(/\+/g," ")),p.deviceIDs&&p.deviceIDs[l]?p.deviceIDs[l].hasCleared||u.push(d):u.push(d);return a.unreadNotificationCount=i,e.resolve(u)}return e.resolve([])},function(t){return e.reject(t)}),e.promise},s.getUnreadNotificationsCount=function(){var e,i;return e=0,i=t.defer(),firebase.database().ref("notifications").once("value").then(function(t){var n,r,o,s,c,u,d;if(console.log("GET UNREAD"),t.val()){for(d=t.val(),o=Object.keys(d),n=r=0,s=o.length;0<=s?r<s:r>s;n=0<=s?++r:--r)d[o[n]].id=o[n],c=d[o[n]],console.log(c,"NOTF"),c.deviceIDs?(u=c.deviceIDs[l],u?u.hasCleared===!1&&u.hasSeen===!1&&e++:e++):e++;return a.unreadNotificationCount=e,console.log("TOTAL UNREAD",e),i.resolve(e)}return i.resolve(e)},function(e){return i.reject(e)}),i.promise},s.fetchAllDevices=function(){var e;return e=t.defer(),firebase.database().ref("installation").once("value").then(function(t){return e.resolve(t.val())},function(t){return e.reject(t)}),e.promise},s.deleteNotifications=function(){var e;return e=t.defer(),firebase.database().ref("notifications").once("value").then(function(t){var i,n,r,o,a,s;if(console.log(t.val(),"RESS"),a=t.val()){for(r=Object.keys(a),console.log(r,"keys"),s=[],i=n=0,o=r.length;0<=o?n<o:n>o;i=0<=o?++n:--n)s.push(firebase.database().ref("notifications/"+r[i]+"/deviceIDs/"+l).update({hasCleared:!0}).then(function(t){return e.resolve(t)},function(t){return e.reject(t)}));return s}},function(t){return e.reject(t)}),e.promise},s.updateNotificationStatus=function(e){var i;return console.log(l,e),e?(i=t.defer(),firebase.database().ref("notifications/"+e+"/deviceIDs").child(l).set({hasCleared:!1,hasSeen:!0}).then(function(e){return i.resolve(e)},function(e){return i.reject(e)}),i.promise):i.reject("Notification ID is null")},s.registerDevice=function(e){return s.getDeviceToken().then(function(e){return console.log(e,"DEVICETOKEN -- registerDevice"),s.fetchAllDevices().then(function(t){var i,n,r,o,a;if(t){for(o=Object.keys(t),i=!1,n=r=0,a=o.length;0<=a?r<a:r>a;n=0<=a?++r:--r)t[o[n]].deviceToken===e&&(i=!0);if(i?console.log("deviceAlreadyRegistered"):console.log("newDevice"),!i)return firebase.database().ref("installation").push({device:ionic.Platform.platform(),deviceToken:e})}else if(null===t)return firebase.database().ref("installation").push({device:ionic.Platform.platform(),deviceToken:e})})})},s}]),shortFilmWindow.service("InitialiseService",["$q","DetailsAPI","App","$rootScope","$ImageCacheFactory",function(e,t,i,n,r){return{initialize:function(){var o;return o=void 0,o=void 0,o=e.defer(),i.isOnline()?t.GetVideoDetails().then(function(e){return n.vData=e}).then(function(e){var i;return i=[],_.each(e.defaults.content,function(e,t){switch(t){case"genre":return _.each(e,function(e){return i.push(e.genre_image_url)});case"playlists":return _.each(e,function(e){return i.push(e.playlist_image_url)});case"popular":return _.each(e,function(e,t){switch(t){case"awesome_playlist":return _.each(e.awesome_playlist,function(e){return i.push(e.playlist_image_url)});case"new_additions":return _.each(e.new_additions,function(e){return i.push(e.image)});case"weekly_premiere":return _.each(e.weekly_premiere,function(e){return i.push(e.image)})}})}}),r.Cache([i]),t.setData({premiere:n.vData.defaults.content.popular.weekly_premiere,new_addition:n.vData.defaults.content.popular.new_additions,mstPopular:n.vData.defaults.content.popular.most_popular,noteworthy:n.vData.defaults.content.popular.noteworthy,awesome_playlist:n.vData.defaults.content.popular.awesome_playlist,genre:n.vData.defaults.content.genre,playlist:n.vData.defaults.content.playlists}),o.resolve(n.vData)}):o.reject(),o.promise}}}]),shortFilmWindow.service("ParseNotificationService",["$q","$window","ParseConfiguration","$rootScope",function(e,t,i,n){return{getNotificationsWithStatus:function(){var t,n;return console.log("GETNOTIFICATIONSWITHSTATUS"),t=e.defer(),n=i.installationId,console.log("ParseConfiguration.installationId",i.installationId),Parse.Cloud.run("listAllNotificationsForUser",{installation_id:n},{success:function(e){var i;i=[],_.each(e,function(e){var t,n;return t={},e.attributes.notificationId.attributes.movieDetails&&(t=angular.fromJson(decodeURIComponent(e.attributes.notificationId.attributes.movieDetails)),n={fromnow:moment(e.attributes.createdAt).fromNow(),createdAt:e.attributes.createdAt,notificationId:e.attributes.notificationId.id,installationId:e.attributes.installationId.id,alert:e.attributes.notificationId.attributes.alert,movieDetails:t,status:e.attributes.status}),_.isString(n.movieDetails.title)&&n.movieDetails.title.indexOf("+")!==-1&&(n.movieDetails.title=n.movieDetails.title.replace(/\+/g," ")),_.isString(n.movieDetails.director)&&n.movieDetails.director.indexOf("+")!==-1&&(n.movieDetails.director=n.movieDetails.director.replace(/\+/g," ")),_.isString(n.movieDetails.tagline)&&n.movieDetails.tagline.indexOf("+")!==-1&&(n.movieDetails.tagline=n.movieDetails.tagline.replace(/\+/g," ")),i.push(n)}),t.resolve(i)},error:function(e){t.reject(e)}}),t.promise},getUnreadNotificationsCount:function(){var t,n;return t=e.defer(),n=i.installationId,Parse.Cloud.run("countUnreadNotifications",{installation_id:n},{success:function(e){t.resolve(e)},error:function(e){t.reject("0")}}),t.promise},updateNotificationStatus:function(t){var n,r;return n=e.defer(),r=i.installationId,Parse.Cloud.run("updateNotificationStatusAsRead",{installation_id:r,notification_id:t},{success:function(e){n.resolve(e)},error:function(e){n.reject(e)}}),n.promise},deleteNotifications:function(){var t,n;return t=e.defer(),n=i.installationId,Parse.Cloud.run("deleteAllNotification",{installation_id:n},{success:function(e){t.resolve(e)},error:function(e){t.reject(e)}}),t.promise}}}]),shortFilmWindow.controller("sidebarCtrl",["FirebaseApi","$scope","$rootScope","$ionicModal","$ionicPopup","$ionicSideMenuDelegate","App","DetailsAPI","$ionicLoading","$window","Storage","$timeout",function(e,t,i,n,r,o,a,l,s,c,u,d){return t.showsearchbar=!1,t.searchDisplay="tabview",t.errorType="",t.SearchResult=[],t.classname="",t.watchListCount="0",i.unreadNotificationCount=0,t.getwatchlistDetails=[],t.hideSearchBar=function(){return t.showsearchbar="hide"},t.checkIfaddedToWatchList=function(e){var i;return t.getwatchlistDetails.length>0?(i=_.findIndex(t.getwatchlistDetails,{movie_id:e}),i!==-1?"selected":"notselected"):"notselected"},t.findIndexInWatchlist=function(e){var i;return i=_.findIndex(t.getwatchlistDetails,{movie_id:e})},t.addwatchlist=function(e){var i,n;return n={movie_id:e.movie_id,singleVideoarray:e},i=t.findIndexInWatchlist(e.movie_id),i===-1?(t.getwatchlistDetails.push(n),u.watchlistDetails("set",t.getwatchlistDetails)):(t.getwatchlistDetails.splice(i,1),u.watchlistDetails("set",t.getwatchlistDetails))},i.$on("openNotification",function(e,t){return a.fromNotification=1,console.log("PUSH NOTIFICATION",t,"SIDEBAR"),l.videoId=t.payload.movieId,i.unreadNotificationCount&&i.unreadNotificationCount--,a.notificationPayload=t,a.navigate("init")}),i.$on("receiveNotification",function(e,t){return console.log("PUSH NOTIFICATION RECEIVED",t),i.unreadNotificationCount++}),t.device_height=c.innerHeight,
t.hgt=parseInt(t.device_height)-parseInt(45),t.getwatchlistcount=function(){return u.watchlistDetails("get").then(function(e){return _.isNull(e)&&(e=[]),t.watchlistDetails=e,0===t.watchlistDetails.length?(t.watchListCount="0",t.$apply()):t.watchlistDetails.length>0?(t.watchListCount=t.watchlistDetails.length,t.$apply()):(t.watchListCount="0",t.$apply())})},i.getnotificationcount=function(){return e.getUnreadNotificationsCount().then(function(e){return console.log("GET UNREAD ROOT"),i.unreadNotificationCount=e})},t.singlePlayService=function(e){return l.singleVideoarray.movie_id=e.movie_id,l.singleVideoarray.singleVideoarray=e,a.navigate("init")},t.searchMovie=function(e){if(null==e&&(e=null),console.log(e),e)return u.watchlistDetails("get").then(function(i){return _.isNull(i)&&(i=[]),t.watchlistDetails=i,t.searchDisplay="loader",a.hideKeyboard(),l.searchResult(e).then(function(e){var i,n;return _.isEmpty(t.SearchResult)||(t.SearchResult=[]),t.SearchResult=e,n=c.innerWidth,i=c.innerHeight,t.hgt=i-32,d(function(){return 0===t.SearchResult.length?(t.errorType="no_Search_result",t.searchDisplay="error"):(t.classname="searchResult",t.searchDisplay="searchresult")})},function(e){return t.errorType="offline",t.searchDisplay="error"})})},t.onTapToRetry=function(){return t.searchMovie()},t.hide=function(){return s.hide(),{hideOnStateChange:!1}},t.displayWeb=function(e){return o.toggleLeft(),window.open(e,"_system"),!0},t.submit=function(){return a.navigate("onlineSubmit")},t.slideContent=function(){t.getwatchlistcount(),o.toggleLeft()},t.openModal=function(){t.taskModal.show()},t.closeModal=function(){t.taskModal.hide()},t.showPopup=function(){var e;return t.data={},e=r.show({template:'<input class="padding" type="password" ng-modal="data-wifi">',title:"Enter Wi-Fi Password",subTitle:"Please use normal things",scope:t,buttons:[{text:"Cancel"},{text:"Save",cssClass:"test",type:"button-positive"}]})}}]),shortFilmWindow.factory("Storage",["$rootScope","$q",function(e,t){var i;return i={},i.watchlistDetails=function(t,i){switch(t){case"set":return localforage.setItem("watchlist_details",i,function(t,n){return e.$broadcast("watchListUpdate",i)});case"get":return localforage.getItem("watchlist_details");case"remove":return localforage.removeItem("watchlist_details")}},i.deviceToken=function(e,i){var n;switch(null==i&&(i={}),n=t.defer(),e){case"set":localforage.setItem("device_token",i).then(function(){return n.resolve()});break;case"get":localforage.getItem("device_token").then(function(e){return n.resolve(e)});break;case"remove":localforage.removeItem("device_token").then(function(){return n.resolve()})}return n.promise},i}]),shortFilmWindow.controller("genreCtrl",["$rootScope","$scope","App","PulltorefreshAPI","DetailsAPI","$ionicLoading","$stateParams",function(e,t,i,n,r,o,a){return t.notificationPayload=a.data,t.doRefresh=function(){return n.pullrequest().then(function(e){return function(e){return n.saveData({premiere:e.defaults.content.popular.weekly_premiere,new_addition:e.defaults.content.popular.new_additions,mstPopular:e.defaults.content.popular.most_popular,noteworthy:e.defaults.content.popular.noteworthy,awesome_playlist:e.defaults.content.popular.awesome_playlist,genre:e.defaults.content.genre,playlist:e.defaults.content.playlists}),t.genreobj=r.genre_array,t.$broadcast("scroll.refreshComplete"),o.hide()}}(this),function(e){return function(e){return t.$broadcast("scroll.refreshComplete"),o.hide()}}(this))},t.init=function(){return t.genre=r.genre_array},t.singleGenre=function(e){return r.videoId=e,i.navigate("singleGenre")}}]),shortFilmWindow.factory("GenreAPI",["$q","App","$http",function(e,t,i){var n;return n={},n.GetSingleGenre=function(t){var n;return n=e.defer(),i.get(GLOBAL_URL+("/wp-json/get_genre_videos?genre_id="+t)).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e)}),n.promise},n.ApplyFilter=function(t){var n;return n=e.defer(),i.get(GLOBAL_URL+("/wp-json/get_genre_videos?genre_id="+t[0]+"&sort_key="+t[1]+"&language_id="+t[2])).then(function(e){return n.resolve(e.data)},function(e){return n.reject(e)}),n.promise},n}]),shortFilmWindow.controller("singleGenre",["$scope","$ionicLoading","App","GenreAPI","DetailsAPI","$ionicHistory","share","$window","Storage","$timeout",function(e,t,i,n,r,o,a,l,s,c){return e.lang=null,e.sort_key=null,e.errorType="",e.filterimg="img/icons/filter_grey.png",e.sortimg="img/icons/sort_notapplied.png",e.display="loader",e.Popuparray=[],e.PopuparrayClicked=["img/icons/fresh_red.png","img/icons/popularity_red.png","img/icons/length-Red.png"],e.PopuparrayImages=["img/icons/fresh_grey.png","img/icons/popularity_grey.png","img/icons/length_grey.png"],e.refreshSwiper=!0,e.share=function(e){return a.shareNative(e,"category")},e.checkIfaddedToWatchList=function(t){var i;return e.getwatchlistDetails.length>0?(i=_.findIndex(e.getwatchlistDetails,{movie_id:t}),i!==-1?"selected":"notselected"):"notselected"},e.findIndexInWatchlist=function(t){var i;return i=_.findIndex(e.getwatchlistDetails,{movie_id:t})},e.addwatchlist=function(t){var i,n;return n={movie_id:t.movie_id,singleVideoarray:t},i=e.findIndexInWatchlist(t.movie_id),i===-1?(e.getwatchlistDetails.push(n),s.watchlistDetails("set",e.getwatchlistDetails)):(e.getwatchlistDetails.splice(i,1),s.watchlistDetails("set",e.getwatchlistDetails))},e.init=function(){return s.watchlistDetails("get").then(function(t){var i,o;return _.isNull(t)&&(t=[]),e.getwatchlistDetails=t,r.GlobalChild_array.length>0?(console.log("Len not zero"),e.genreData=r.GlobalChild_array,e.genre=r.Global_array,e.sortData=r.Sort,e.language=r.Filter,o=l.innerWidth,i=l.innerHeight,e.used_height=161,e.hgt=i-e.used_height,e.display="result",console.log("Global Child array",e.genreData)):n.GetSingleGenre(r.videoId).then(function(t){return console.log("Length zero"),r.GlobalChild_array=t.movies,r.Global_array=t.genre,r.Filter=t.filters.languages,r.Sort=t.sort_keys,e.genreData=t.movies,e.genre=t.genre,e.sortData=t.sort_keys,e.language=t.filters.languages,e.display="result",o=l.innerWidth,i=l.innerHeight,e.used_height=161,e.hgt=i+3-e.used_height,console.log("Global Child array",e.genreData)},function(t){return e.display="error"})})},e.sortGenre=function(){return t.show({scope:e,templateUrl:"filterPopup/sortPopupgener.html",hideOnStateChange:!0})},e.langSelected=function(t){return e.lang=t},e.filterGenre=function(){return t.show({scope:e,templateUrl:"filterPopup/filterpopup.html",hideOnStateChange:!0})},e.getId=function(t){return e.sort_key=t,e.Popuparray=["img/icons/fresh_grey.png","img/icons/popularity_grey.png","img/icons/length_grey.png"],e.Popuparray[t]=e.PopuparrayClicked[t],e.txtcolor=["","",""],e.txtcolor[t]="color:#AF152F"},e.popup=function(){return _.isNull(e.sort_key)?e.Popuparray=e.PopuparrayImages:(e.Popuparray=["img/icons/fresh_grey.png","img/icons/popularity_grey.png","img/icons/length_grey.png"],e.Popuparray[e.sort_key]=e.PopuparrayClicked[e.sort_key],e.txtcolor=["","",""],e.txtcolor[e.sort_key]="color:#AF152F")},e.FiltersortApply=function(){var i;return _.isNull(e.lang)?e.filterimg="img/icons/filter_grey.png":e.filterimg="img/icons/filter_red.png",_.isNull(e.sort_key)?e.sortimg="img/icons/sort_notapplied.png":e.sortimg=e.PopuparrayClicked[e.sort_key],i=[r.Global_array.genre_id,e.sort_key,e.lang],t.hide(),e.display="loader",n.ApplyFilter(i).then(function(i){return r.GlobalChild_array=i.movies,r.Global_array=i.genre,r.Filter=i.filters.languages,r.Sort=i.sort_keys,r.GlobalChild_array.length>0?(e.display="result",e.genreData=i.movies,e.genre=i.genre,e.sortData=i.sort_keys,e.language=i.filters.languages,t.hide(),e.refreshSwiper=!1,c(function(){return e.refreshSwiper=!0,e.display="result"},100)):(e.errorType="no_Search_result",e.display="error")},function(t){return e.errorType="",e.display="error"}),t.hide()},e.hide=function(){return t.hide(),{hideOnStateChange:!1}},e.reset=function(){var i;return e.sortimg="img/icons/sort_notapplied.png",e.filterimg="img/icons/filter_grey.png",e.sort_key=null,e.lang=null,i=[r.Global_array.genre_id,e.sort_key,e.lang],t.hide(),e.display="loader",n.ApplyFilter(i).then(function(i){return r.GlobalChild_array=i.movies,r.Global_array=i.genre,r.Filter=i.filters.languages,r.Sort=i.sort_keys,e.genreData=i.movies,e.genre=i.genre,e.sortData=i.sort_keys,e.language=i.filters.languages,t.hide(),e.display="result"},function(i){return e.errorType="",e.display="error",t.hide()})},e.hideNoReset=function(){return t.hide(),{hideOnStateChange:!1}},e.singlePlayService=function(e){return r.singleVideoarray.movie_id=e.movie_id,r.singleVideoarray.singleVideoarray=e,i.navigate("init")},e.back=function(){var e;return r.GlobalChild_array=[],r.Global_array=[],r.Filter=[],r.Sort=[],e=-1,i.goBack(e)},e.view={onTapToRetry:function(){return e.init(),e.display="loader"}}}]),shortFilmWindow.controller("playlistCtrl",["$scope","App","PulltorefreshAPI","DetailsAPI","$ionicLoading",function(e,t,i,n,r){return e.doRefresh=function(){return i.pullrequest().then(function(t){return function(t){return i.saveData({premiere:t.defaults.content.popular.weekly_premiere,new_addition:t.defaults.content.popular.new_additions,mstPopular:t.defaults.content.popular.most_popular,noteworthy:t.defaults.content.popular.noteworthy,awesome_playlist:t.defaults.content.popular.awesome_playlist,genre:t.defaults.content.genre,playlist:t.defaults.content.playlists}),e.playlist=n.playlist_array,e.$broadcast("scroll.refreshComplete"),r.hide()}}(this),function(t){return function(t){return e.$broadcast("scroll.refreshComplete"),r.hide()}}(this))},e.test=function(){return e.playlist=n.playlist_array},e.singleplaylist=function(e){return n.videoId=e,t.navigate("singlePlaylist")}}]),shortFilmWindow.factory("PlaylistAPI",["$q","App","$http",function(e,t,i){var n;return n={},n.GetSingleplaylist=function(t){var n;return n=e.defer(),i.get(GLOBAL_URL+("/wp-json/get_playlist_videos/?playlist_id="+t)).then(function(e){return n.resolve(angular.fromJson(e.data))},function(e){return n.reject(e)}),n.promise},n}]),shortFilmWindow.controller("singlePlaylist",["$scope","$rootScope","$ionicScrollDelegate","$ionicLoading","App","PlaylistAPI","DetailsAPI","$ionicHistory","share","$window","$timeout","Storage",function(e,t,i,n,r,o,a,l,s,c,u,d){return e.display="loader",e.getwatchlistDetails=[],t.slideHeader=!1,t.slideHeaderPrevious=0,e.checkIfaddedToWatchList=function(t){var i;return e.getwatchlistDetails.length>0?(i=_.findIndex(e.getwatchlistDetails,{movie_id:t}),i!==-1?"selected":"notselected"):"notselected"},e.findIndexInWatchlist=function(t){var i;return i=_.findIndex(e.getwatchlistDetails,{movie_id:t})},e.addwatchlist=function(t){var i,n;return n={movie_id:t.movie_id,singleVideoarray:t},i=e.findIndexInWatchlist(t.movie_id),i===-1?(e.getwatchlistDetails.push(n),d.watchlistDetails("set",e.getwatchlistDetails)):(e.getwatchlistDetails.splice(i,1),d.watchlistDetails("set",e.getwatchlistDetails))},e.share=function(e){return s.shareNative(e,"playlist")},e.init=function(){return d.watchlistDetails("get").then(function(t){var i,r;return _.isNull(t)&&(t=[]),e.getwatchlistDetails=t,a.GlobalChild_array.length>0?(e.playlistData=a.GlobalChild_array,e.playlist=a.Global_array,e.display="result",r=c.innerWidth,i=c.innerHeight,e.used_height=164,e.hgt=i-e.used_height,e.headerwidth=r-100-27):(e.display="loader",o.GetSingleplaylist(a.videoId).then(function(t){return a.Global_array=t.playlist,a.GlobalChild_array=t.movies,e.playlistData=t.movies,e.playlist=t.playlist,e.display="result",r=c.innerWidth,i=c.innerHeight,e.used_height=164,e.hgt=i-e.used_height,e.headerwidth=r-100-27,n.hide()},function(t){return e.display="error",n.hide()}))})},e.singlePlayService=function(e){return a.singleVideoarray.movie_id=e.movie_id,a.singleVideoarray.singleVideoarray=e,r.navigate("init")},e.back=function(){var e;return a.Global_array=[],a.GlobalChild_array=[],e=-1,r.goBack(e)},e.view={onTapToRetry:function(){return e.init()}}}]),shortFilmWindow.controller("popularCtrl",["$scope","$rootScope","App","PulltorefreshAPI","DetailsAPI","$ionicLoading","$window","InitialiseService","Storage","$timeout","GenreAPI",function(e,t,i,n,r,o,a,l,s,c,u){var d,g,p,h;return e.getwatchlistDetails=[],e.currentCard={},e.refreshSwiper=!0,t.$on("watchListUpdate",function(t,i){return e.getwatchlistDetails=i,e.checkIfaddedlist()}),t.$on("refreshContent",function(t,i){return e.doRefresh()}),e.detectSlideChange=function(t){return e.currentCard=e.allContentArray[t.activeIndex]},e.singlePlaylistGenre=function(e,t){if(r.videoId=e,"playlist"===t&&i.navigate("singlePlaylist"),"category"===t)return i.navigate("singleGenre")},e.checkIfaddedlist=function(){if(_.each(e.allContentArray,function(t,i){return e.allContentArray[i].addedToWatchList=0}),e.getwatchlistDetails.length>0)return _.each(e.getwatchlistDetails,function(t){var i;if(i=_.findIndex(e.allContentArray,{movieId:t.movie_id}),i!==-1)return e.allContentArray[i].addedToWatchList=1})},g=function(t){var i;return i=_.findIndex(e.allContentArray,{movieId:t})},d=function(t){var i;return i=_.findIndex(e.getwatchlistDetails,{movie_id:t})},e.updateFlagInallContentArray=function(t,i){var n;return n=g(t),e.allContentArray[n].addedToWatchList=i},e.addwatchlist=function(t){var i,n;return n={movie_id:t.movieId,singleVideoarray:t.content},i=d(t.movieId),i===-1?(e.updateFlagInallContentArray(t.movieId,1),e.getwatchlistDetails.push(n),s.watchlistDetails("set",e.getwatchlistDetails)):(e.updateFlagInallContentArray(t.movieId,0),e.getwatchlistDetails.splice(i,1),s.watchlistDetails("set",e.getwatchlistDetails))},e.doRefresh=function(){return console.log("Refreshing"),i.isOnline()?(n.pullrequest().then(function(t){return function(t){return console.log("data from pull request"),console.log(t),e.checkNetwork=!0,n.saveData({premiere:t.defaults.content.popular.weekly_premiere,new_addition:t.defaults.content.popular.new_additions,mstPopular:t.defaults.content.popular.most_popular,noteworthy:t.defaults.content.popular.noteworthy,awesome_playlist:t.defaults.content.popular.awesome_playlist,genre:t.defaults.content.genre,playlist:t.defaults.content.playlists}),e.premeiere=r.array,e.addition=r.array_addition,e.noteworthy=r.array_noteworthy,e.awplalist=r.array_awplalist,e.videoId=r.array.videoId,e.$broadcast("scroll.refreshComplete"),o.hide(),e.initApp()}}(this),function(t){return e.$broadcast("scroll.refreshComplete")}),o.hide()):(e.checkNetwork=!1,console.log("not calling pull api"))},e.singlePlayService=function(e){return r.singleVideoarray.movie_id=e.movie_id,r.singleVideoarray.singleVideoarray=e,i.navigate("init")},e.initApp=function(){return console.log("Inside init app"),e.used_height=191,e.hgt=t.device_height+3-e.used_height,i.isOnline()?p():(e.checkNetwork=!1,e.display="nonetwork")},p=function(){var t,i,n,o,a;return a=[],t=[],o=[],i=[],n=[],e.allContentArray=[],a.push({order:1,cardtitle:"This Week's Release",p:"New Cinema of New India",iconimg:"weekly_premiere",content:r.array,addedToWatchList:0,movieId:r.array.movie_id}),o=_.map(r.array_noteworthy,function(e,t,i){return{order:2,cardtitle:"Noteworthy",p:e.genreCategory,iconimg:"noteworthy",content:e,addedToWatchList:0,movieId:e.movie_id}}),t=_.map(r.array_addition,function(e,t,i){return{order:3,cardtitle:"New Additions",p:"Just starting out on their big journey!",iconimg:"new_additions",content:e,addedToWatchList:0,movieId:e.movie_id}}),n.push({order:5,cardtitle:"Genre List",p:"Choose Your Genre",iconimg:"genre",content:r.genre_array,addedToWatchList:0,movieId:""}),i.push({order:6,cardtitle:"Awesome Playlist",p:"Sit back and relax with some popcorn!",iconimg:"awesome_playlists",content:r.array_awplalist,addedToWatchList:0,movieId:""}),e.allContentArray=_.union(a,o,t,n,i),console.log("Data in final array"),console.log(e.allContentArray),e.currentCard=e.allContentArray[0],e.refreshSwiper=!1,c(function(){return e.refreshSwiper=!0,h()},1e3),e.display="result"},h=function(){return s.watchlistDetails("get").then(function(t){return _.isNull(t)&&(t=[]),e.getwatchlistDetails=t,e.checkIfaddedlist()})}}]);